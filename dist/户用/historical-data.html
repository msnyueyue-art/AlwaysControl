<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>历史数据 - 户用家庭储能-能源管理系统</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- 顶部导航栏 -->
    <header class="header">
        <div class="logo">Always Control Technology</div>
        <div class="header-center">
            <div class="date-display">2025/09/23</div>
            <select class="language-selector">
                <option value="zh-CN">简体中文</option>
                <option value="en-US">English</option>
            </select>
        </div>
        <div class="header-actions">
            <div class="action-item">
                <div class="action-icon">+</div>
                <div class="action-text">添加设备</div>
            </div>
            <div class="action-item">
                <div class="action-icon">🔔</div>
                <div class="action-text">信息通知</div>
            </div>
            <div class="action-item">
                <div class="action-icon">📖</div>
                <div class="action-text">新手教程</div>
            </div>
        </div>
    </header>

    <!-- 侧边栏 -->
    <nav class="sidebar">
        <div class="user-profile">
            <div class="user-avatar">👤</div>
            <div class="user-name">user_demo</div>
        </div>
        <div class="nav-menu">
            <a href="index.html" class="nav-item">
                <div class="nav-icon">🏠</div>
                <span>首页</span>
            </a>
            <a href="historical-data.html" class="nav-item active">
                <div class="nav-icon">📊</div>
                <span>历史数据</span>
            </a>
            <a href="message-center.html" class="nav-item">
                <div class="nav-icon">🔔</div>
                <span>消息中心</span>
            </a>
            <a href="help-support.html" class="nav-item">
                <div class="nav-icon">❓</div>
                <span>帮助与支持</span>
            </a>
            <a href="device-management.html" class="nav-item">
                <div class="nav-icon">🏢</div>
                <span>设备管理</span>
            </a>
            <a href="settings.html" class="nav-item">
                <div class="nav-icon">⚙️</div>
                <span>设置</span>
            </a>
        </div>
        <div class="version-info">
            <span>版本号 1.0.12</span>
            <span>▼</span>
        </div>
    </nav>

    <!-- 主内容区域 -->
    <main class="main-content">
        <!-- 同步数据提示 -->
        <div style="background: #e6f7ff; border: 1px solid #91d5ff; border-radius: 4px; padding: 12px 16px; margin-bottom: 20px; color: #1890ff;">
            设备同步数据有可能延迟,如发现数据异常,请点击: <button class="btn btn-primary sync-data-btn" style="margin-left: 8px;">同步数据</button>
        </div>

        <!-- 标签页导航 -->
        <div style="background: #fff; border-radius: 8px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);">
            <div style="display: flex; gap: 20px; border-bottom: 1px solid #f0f0f0; margin-bottom: 20px;">
                <div style="padding: 12px 0; border-bottom: 2px solid #1890ff; color: #1890ff; font-weight: 600; cursor: pointer;">
                    能量统计
                </div>
                <div style="padding: 12px 0; color: #666; cursor: pointer;">
                    收益统计
                </div>
                <div style="padding: 12px 0; color: #666; cursor: pointer;">
                    绿色减排
                </div>
            </div>

            <!-- KPI指标卡片 -->
            <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 20px; margin-bottom: 30px;">
                <div class="card" style="margin-bottom: 0;">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <div style="width: 40px; height: 40px; background: #722ed1; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; font-size: 20px;">🏠</div>
                        <div>
                            <div style="font-size: 14px; color: #666; margin-bottom: 4px;">家庭负载</div>
                            <div style="font-size: 20px; font-weight: 600; color: #333;">27.738kWh</div>
                        </div>
                    </div>
                </div>
                
                <div class="card" style="margin-bottom: 0;">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <div style="width: 40px; height: 40px; background: #faad14; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; font-size: 20px;">☀️</div>
                        <div>
                            <div style="font-size: 14px; color: #666; margin-bottom: 4px;">光伏</div>
                            <div style="font-size: 20px; font-weight: 600; color: #333;">12.551kWh</div>
                        </div>
                    </div>
                </div>
                
                <div class="card" style="margin-bottom: 0;">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <div style="width: 40px; height: 40px; background: #1890ff; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; font-size: 20px;">⚡</div>
                        <div>
                            <div style="font-size: 14px; color: #666; margin-bottom: 4px;">电网</div>
                            <div style="font-size: 20px; font-weight: 600; color: #333;">26.348kWh</div>
                        </div>
                    </div>
                </div>
                
                <div class="card" style="margin-bottom: 0;">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <div style="width: 40px; height: 40px; background: #52c41a; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; font-size: 20px;">🔋</div>
                        <div>
                            <div style="font-size: 14px; color: #666; margin-bottom: 4px;">电池</div>
                            <div style="font-size: 20px; font-weight: 600; color: #333;">0.000kWh</div>
                        </div>
                    </div>
                </div>
                
                <div class="card" style="margin-bottom: 0;">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <div style="width: 40px; height: 40px; background: #faad14; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; font-size: 20px;">🚗</div>
                        <div>
                            <div style="font-size: 14px; color: #666; margin-bottom: 4px;">充电桩</div>
                            <div style="font-size: 20px; font-weight: 600; color: #333;">11.161kWh</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 图表控制栏 -->
            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px;">
                <div style="display: flex; align-items: center; gap: 12px;">
                    <select style="padding: 6px 12px; border: 1px solid #d9d9d9; border-radius: 4px; background: #fff;">
                        <option>日</option>
                        <option>周</option>
                        <option>月</option>
                        <option>年</option>
                    </select>
                    <input type="date" value="2025-09-23" style="padding: 6px 12px; border: 1px solid #d9d9d9; border-radius: 4px;">
                </div>
                <button class="btn btn-secondary">
                    <span>👁️</span>
                    能量流占比
                </button>
            </div>

            <!-- 能量使用图表 -->
            <div style="background: #fff; border: 1px solid #f0f0f0; border-radius: 8px; padding: 20px;">
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px;">
                    <div>
                        <div style="font-size: 16px; font-weight: 600; color: #333; margin-bottom: 8px;">kW</div>
                        <div style="color: #1890ff; font-weight: 600;">2.913</div>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-size: 14px; color: #666;">当前时间: 11:55</div>
                        <div style="font-size: 14px; color: #666;">homeUsageInput 0</div>
                    </div>
                </div>
                
                <!-- 图表区域 -->
                <div id="energyChart" class="chart-container" style="height: 300px; position: relative;">
                    <!-- 模拟图表数据 -->
                    <canvas id="chartCanvas" width="800" height="300"></canvas>
                </div>
                
                <!-- X轴时间标签 -->
                <div style="display: flex; justify-content: space-between; margin-top: 10px; font-size: 12px; color: #666;">
                    <span>00:00</span>
                    <span>06:00</span>
                    <span>12:00</span>
                    <span>18:00</span>
                    <span>23:30</span>
                </div>
            </div>
        </div>
    </main>

    <script src="js/common.js"></script>
    <script>
        // 初始化能量图表
        document.addEventListener('DOMContentLoaded', function() {
            // 生成模拟数据
            const energyData = [];
            const hours = [];
            
            // 生成24小时的数据
            for (let i = 0; i < 24; i++) {
                const hour = i;
                let value;
                
                // 模拟数据模式：夜间高负载，白天低负载
                if (hour >= 0 && hour < 6) {
                    value = 2.8 + Math.random() * 0.2; // 2.8-3.0 kW
                } else if (hour >= 6 && hour < 9) {
                    value = 0.5 + Math.random() * 0.5; // 0.5-1.0 kW
                } else if (hour >= 9 && hour < 11) {
                    value = 2.8 + Math.random() * 0.2; // 2.8-3.0 kW
                } else if (hour >= 11) {
                    value = 0; // 11:55之后无数据
                } else {
                    value = 1.0 + Math.random() * 1.0; // 1.0-2.0 kW
                }
                
                energyData.push({
                    label: hour < 10 ? `0${hour}:00` : `${hour}:00`,
                    value: value
                });
                
                hours.push(hour);
            }
            
            // 初始化图表
            ChartManager.init('energyChart');
            ChartManager.drawAreaChart('energyChart', energyData, {
                color: '#1890ff',
                maxValue: 3.0,
                showGrid: true,
                showLabels: false
            });
            
            // 绘制当前时间指示线
            const canvas = document.getElementById('chartCanvas');
            const ctx = canvas.getContext('2d');
            
            // 计算当前时间位置 (11:55)
            const currentHour = 11 + 55/60;
            const x = (currentHour / 23) * canvas.width;
            
            ctx.strokeStyle = '#ff4d4f';
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            ctx.moveTo(x, 0);
            ctx.lineTo(x, canvas.height);
            ctx.stroke();
            
            // 绘制工具提示
            ctx.fillStyle = '#333';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('11:55', x, 20);
            ctx.fillText('homeUsageInput 0', x, 35);
        });
    </script>
</body>
</html>
