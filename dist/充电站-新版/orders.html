<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>充电订单管理 - 电动汽车充电站管理系统</title>
  <link rel="icon" href="../充电站/logo.png">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#007AFF',
            success: '#10b981',
            warning: '#f59e0b',
            danger: '#ef4444',
            muted: '#6b7280'
          },
          boxShadow: {
            card: '0 2px 8px rgba(0,0,0,0.08)'
          },
          borderRadius: {
            card: '16px'
          }
        }
      }
    }
  </script>
  <style>
    body{background:#F8F9FA;margin:0}
    .fixed-header{display:none !important}
    .fixed-sidebar{display:none !important}
    .page-wrap{padding-top:0 !important;padding-left:0 !important}
    .grid-cols-14{grid-template-columns:repeat(14,minmax(0,1fr))}
    .w-15{width:60px}
  </style>
</head>
<body>
  <!-- 顶部固定导航 -->
  <header class="fixed-header bg-white border-b border-gray-200">
    <div class="max-w-screen-2xl mx-auto px-4 lg:px-6 h-16 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <a href="index.html" class="text-gray-700 hover:text-gray-900">首页</a>
        <span class="text-gray-300">/</span>
        <span class="font-semibold">充电订单管理</span>
      </div>
      <div class="flex items-center gap-3">
        <button id="langToggle" class="px-3 py-2 text-sm text-gray-600 hover:text-gray-900 border border-gray-300 rounded-lg">EN/中文</button>
        <button id="themeToggle" class="px-3 py-2 text-sm text-gray-600 hover:text-gray-900 border border-gray-300 rounded-lg">切换主题</button>
        <div class="flex items-center gap-2">
          <span class="text-sm text-gray-600">管理员</span>
          <button id="logoutBtn" class="px-3 py-2 text-sm text-gray-600 hover:text-gray-900 border border-gray-300 rounded-lg">退出登录</button>
        </div>
      </div>
    </div>
  </header>

  <!-- 左侧固定菜单 -->
  <aside class="fixed-sidebar hidden lg:block">
    <nav class="p-3">
      <a class="block px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-50" href="index.html">首页</a>
      <a class="block px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-50" href="sites.html">站点管理</a>
      <a class="block px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-50" href="piles.html">充电桩管理</a>
      <a class="block px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-50" href="users.html">用户管理</a>
      <a class="block px-3 py-2 rounded-lg bg-blue-50 text-primary" href="orders.html">充电订单管理</a>
      <a class="block px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-50" href="analytics.html">数据分析</a>
      <a class="block px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-50" href="alerts.html">告警管理</a>
      <div class="mt-2 text-xs text-gray-500 px-3">系统管理</div>
      <a class="block px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-50" href="index.html#/system/menus">菜单管理</a>
      <a class="block px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-50" href="index.html#/system/roles">角色管理</a>
      <a class="block px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-50" href="index.html#/system/users">人员管理</a>
      <a class="block px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-50" href="index.html#/system/logs">日志管理</a>
    </nav>
  </aside>

  <!-- 主体内容容器 -->
  <main class="page-wrap">
    <div id="root" class="min-h-screen p-6"></div>
  </main>

  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script>
    const { useMemo, useState, useEffect } = React

    // 假数据
    const MOCK_ORDERS = Array.from({length: 156}).map((_,i)=>({
      id: 'ORD' + String(1000000 + i).padStart(7, '0'),
      stationName: ['虹桥枢纽站', '张江高科站', '徐家汇中心站', '外滩观光站', '临港新片区站', '静安寺站', '人民广场站', '陆家嘴金融站'][i % 8],
      pileId: `PILE-${String(i % 50 + 1).padStart(3, '0')}`,
      gunId: `GUN-${String(i % 100 + 1).padStart(3, '0')}`,
      username: `user_${1000 + i}`,
      phone: '138' + String(10000000 + i).slice(0,8),
      customerType: ['个人用户', '企业用户', 'VIP用户'][i % 3],
      startTime: new Date(Date.now() - Math.random() * 7 * 24 * 60 * 60 * 1000).toISOString().slice(0,19).replace('T', ' '),
      endTime: new Date(Date.now() - Math.random() * 6 * 24 * 60 * 60 * 1000).toISOString().slice(0,19).replace('T', ' '),
      energy: (Math.random() * 50 + 10).toFixed(1),
      electricityFee: (Math.random() * 50 + 20).toFixed(2),
      serviceFee: (Math.random() * 10 + 5).toFixed(2),
      status: i % 3 === 0 ? '充电中' : '已完成'
    }))

    const STATIONS = [
      '虹桥枢纽站', '张江高科站', '徐家汇中心站', '外滩观光站', 
      '临港新片区站', '静安寺站', '人民广场站', '陆家嘴金融站'
    ]

    const Tag = ({ color, text }) => (
      React.createElement('span', { 
        className: 'px-2 py-1 rounded text-xs text-white font-medium', 
        style: { background: color }
      }, text)
    )

    function SearchCard({ onQuery, onReset }){
      const [orderId, setOrderId] = useState('')
      const [stationName, setStationName] = useState('')
      const [phone, setPhone] = useState('')
      const [status, setStatus] = useState('')
      const [startDate, setStartDate] = useState('')
      const [endDate, setEndDate] = useState('')

      const handleQuery = () => {
        onQuery({ orderId, stationName, phone, status, startDate, endDate })
      }

      const handleReset = () => {
        setOrderId('')
        setStationName('')
        setPhone('')
        setStatus('')
        setStartDate('')
        setEndDate('')
        onReset()
      }

      return (
        React.createElement('div', { className: 'bg-white shadow-card rounded-card border border-gray-200 p-6 mb-6' },
          React.createElement('div', { className: 'flex items-end justify-between gap-4 flex-wrap' },
            React.createElement('div', { className: 'flex-1 grid grid-cols-1 md:grid-cols-5 gap-4' },
              React.createElement('div', null,
                React.createElement('label', { className: 'block text-sm text-gray-600 mb-2' }, '订单号'),
                React.createElement('input', { 
                  className: 'w-52 h-9 border border-gray-300 rounded-lg px-3 text-sm', 
                  placeholder: '请输入订单号', 
                  value: orderId, 
                  onChange: e => setOrderId(e.target.value) 
                })
              ),
              React.createElement('div', null,
                React.createElement('label', { className: 'block text-sm text-gray-600 mb-2' }, '电站名称'),
                React.createElement('select', { 
                  className: 'w-52 h-9 border border-gray-300 rounded-lg px-3 text-sm', 
                  value: stationName, 
                  onChange: e => setStationName(e.target.value) 
                },
                  React.createElement('option', { value: '' }, '全部电站'),
                  STATIONS.map(station => 
                    React.createElement('option', { key: station, value: station }, station)
                  )
                )
              ),
              React.createElement('div', null,
                React.createElement('label', { className: 'block text-sm text-gray-600 mb-2' }, '用户手机号'),
                React.createElement('input', { 
                  className: 'w-52 h-9 border border-gray-300 rounded-lg px-3 text-sm', 
                  placeholder: '请输入手机号', 
                  value: phone, 
                  onChange: e => setPhone(e.target.value) 
                })
              ),
              React.createElement('div', null,
                React.createElement('label', { className: 'block text-sm text-gray-600 mb-2' }, '订单状态'),
                React.createElement('select', { 
                  className: 'w-52 h-9 border border-gray-300 rounded-lg px-3 text-sm', 
                  value: status, 
                  onChange: e => setStatus(e.target.value) 
                },
                  React.createElement('option', { value: '' }, '全部状态'),
                  React.createElement('option', { value: '充电中' }, '充电中'),
                  React.createElement('option', { value: '已完成' }, '已完成')
                )
              ),
              React.createElement('div', null,
                React.createElement('label', { className: 'block text-sm text-gray-600 mb-2' }, '时间范围'),
                React.createElement('div', { className: 'flex items-center gap-2' },
                  React.createElement('input', { 
                    type: 'datetime-local',
                    className: 'w-24 h-9 border border-gray-300 rounded-lg px-2 text-sm', 
                    value: startDate, 
                    onChange: e => setStartDate(e.target.value) 
                  }),
                  React.createElement('span', { className: 'text-gray-400' }, '至'),
                  React.createElement('input', { 
                    type: 'datetime-local',
                    className: 'w-24 h-9 border border-gray-300 rounded-lg px-2 text-sm', 
                    value: endDate, 
                    onChange: e => setEndDate(e.target.value) 
                  })
                )
              )
            ),
            React.createElement('div', { className: 'flex items-center gap-3' },
              React.createElement('button', { 
                className: 'w-20 h-9 bg-primary text-white rounded-lg hover:bg-blue-600 text-sm font-medium', 
                onClick: handleQuery 
              }, '查询'),
              React.createElement('button', { 
                className: 'w-20 h-9 bg-gray-500 text-white rounded-lg hover:bg-gray-600 text-sm font-medium', 
                onClick: handleReset 
              }, '重置')
            )
          )
        )
      )
    }

    function TableCard({ data, onDetail, onStop }){
      return (
        React.createElement('div', { className: 'bg-white shadow-card rounded-card border border-gray-200 overflow-hidden' },
          React.createElement('div', { className: 'overflow-x-auto' },
            React.createElement('div', { className: 'min-w-max' },
              React.createElement('div', { className: 'bg-gray-100 px-6 py-4 grid grid-cols-14 text-base font-medium text-gray-900 whitespace-nowrap' },
                React.createElement('div', { className: 'min-w-[60px] text-center' }, '序号'),
                React.createElement('div', { className: 'min-w-[120px] text-center' }, '订单号'),
                React.createElement('div', { className: 'min-w-[120px] text-center' }, '电站名称'),
                React.createElement('div', { className: 'min-w-[120px] text-center' }, '充电桩编号'),
                React.createElement('div', { className: 'min-w-[120px] text-center' }, '充电枪编号'),
                React.createElement('div', { className: 'min-w-[120px] text-center' }, '用户名'),
                React.createElement('div', { className: 'min-w-[120px] text-center' }, '手机号'),
                React.createElement('div', { className: 'min-w-[120px] text-center' }, '客户类型'),
                React.createElement('div', { className: 'min-w-[140px] text-center' }, '开始时间'),
                React.createElement('div', { className: 'min-w-[140px] text-center' }, '结束时间'),
                React.createElement('div', { className: 'min-w-[120px] text-center' }, '充电电量(kWh)'),
                React.createElement('div', { className: 'min-w-[120px] text-center' }, '费用(元)'),
                React.createElement('div', { className: 'min-w-[100px] text-center' }, '状态'),
                React.createElement('div', { className: 'min-w-[200px] text-center' }, '操作')
              ),
              React.createElement('div', { className: 'divide-y divide-gray-200' }, data.map((order, index) => (
                React.createElement('div', { key: order.id, className: 'grid grid-cols-14 items-center px-6 h-14 text-center whitespace-nowrap' },
                  React.createElement('div', { className: 'min-w-[60px] text-sm text-gray-600' }, index + 1),
                  React.createElement('div', { className: 'min-w-[120px] text-sm text-gray-900 font-medium' }, order.id),
                  React.createElement('div', { className: 'min-w-[120px] text-sm text-gray-900' }, order.stationName),
                  React.createElement('div', { className: 'min-w-[120px] text-sm text-gray-600' }, order.pileId),
                  React.createElement('div', { className: 'min-w-[120px] text-sm text-gray-600' }, order.gunId),
                  React.createElement('div', { className: 'min-w-[120px] text-sm text-gray-900' }, order.username),
                  React.createElement('div', { className: 'min-w-[120px] text-sm text-gray-600' }, order.phone),
                  React.createElement('div', { className: 'min-w-[120px] text-sm text-gray-600' }, order.customerType),
                  React.createElement('div', { className: 'min-w-[140px] text-sm text-gray-600' }, order.startTime),
                  React.createElement('div', { className: 'min-w-[140px] text-sm text-gray-600' }, order.endTime),
                  React.createElement('div', { className: 'min-w-[120px] text-sm text-gray-900 font-medium' }, order.energy),
                  React.createElement('div', { className: 'min-w-[120px] text-sm text-gray-900' }, 
                    React.createElement('div', { className: 'text-xs text-gray-500' }, `电费: ¥${order.electricityFee}`),
                    React.createElement('div', { className: 'text-xs text-gray-500' }, `服务费: ¥${order.serviceFee}`),
                    React.createElement('div', { className: 'text-sm font-medium text-primary' }, `总计: ¥${(parseFloat(order.electricityFee) + parseFloat(order.serviceFee)).toFixed(2)}`)
                  ),
                  React.createElement('div', { className: 'min-w-[100px]' }, 
                    order.status === '充电中' 
                      ? React.createElement(Tag, { color: '#007AFF', text: '充电中' })
                      : React.createElement(Tag, { color: '#10b981', text: '已完成' })
                  ),
                  React.createElement('div', { className: 'min-w-[200px] flex items-center justify-center gap-2' }, 
                    React.createElement('button', { 
                      className: 'w-15 h-8 text-sm bg-primary text-white rounded-md hover:bg-blue-600', 
                      onClick: () => onDetail(order) 
                    }, '查看详情'),
                    order.status === '充电中' && React.createElement('button', { 
                      className: 'w-15 h-8 text-sm bg-red-500 text-white rounded-md hover:bg-red-600', 
                      onClick: () => onStop(order) 
                    }, '远程停止')
                  )
                )
              )))
            )
          )
        )
      )
    }

    function Pagination({ total, page, pageSize, onChange }){
      const totalPages = Math.max(1, Math.ceil(total / pageSize))
      const pages = []
      for(let i = 1; i <= totalPages; i++) pages.push(i)
      
      return (
        React.createElement('div', { className: 'flex items-center justify-between bg-white shadow-card rounded-card border border-gray-200 p-4 mt-4' },
          React.createElement('div', { className: 'text-sm text-gray-600' }, `共 ${total} 条记录`),
          React.createElement('div', { className: 'flex items-center gap-2' },
            React.createElement('button', { 
              className: 'px-3 h-9 border border-gray-300 rounded-lg text-sm text-gray-600 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed', 
              disabled: page === 1, 
              onClick: () => onChange(page - 1) 
            }, '上一页'),
            pages.slice(Math.max(0, page - 3), Math.max(0, page - 3) + 5).map(p => (
              React.createElement('button', { 
                key: p, 
                className: `px-3 h-9 rounded-lg text-sm ${p === page ? 'bg-primary text-white' : 'border border-gray-300 text-gray-600 hover:bg-gray-50'}`, 
                onClick: () => onChange(p) 
              }, p)
            )),
            React.createElement('button', { 
              className: 'px-3 h-9 border border-gray-300 rounded-lg text-sm text-gray-600 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed', 
              disabled: page === totalPages, 
              onClick: () => onChange(page + 1) 
            }, '下一页')
          )
        )
      )
    }

    function App(){
      const [query, setQuery] = useState({})
      const [page, setPage] = useState(1)
      const pageSize = 10

      const filtered = useMemo(() => {
        let list = MOCK_ORDERS
        if(query.orderId) list = list.filter(o => o.id.includes(query.orderId))
        if(query.stationName) list = list.filter(o => o.stationName.includes(query.stationName))
        if(query.phone) list = list.filter(o => o.phone.includes(query.phone))
        if(query.status) list = list.filter(o => o.status === query.status)
        if(query.startDate) list = list.filter(o => o.startTime >= query.startDate)
        if(query.endDate) list = list.filter(o => o.startTime <= query.endDate)
        return list
      }, [query])

      const pageData = useMemo(() => {
        const start = (page - 1) * pageSize
        return filtered.slice(start, start + pageSize)
      }, [filtered, page])

      useEffect(() => { setPage(1) }, [query])

      const handleDetail = (order) => {
        alert(`查看订单详情: ${order.id}\n电站: ${order.stationName}\n充电桩: ${order.pileId}\n充电枪: ${order.gunId}\n用户: ${order.username}\n状态: ${order.status}`)
      }

      const handleStop = (order) => {
        if(confirm(`确定要远程停止订单 ${order.id} 的充电吗？`)) {
          alert(`已发送远程停止指令到订单 ${order.id}`)
          // 这里可以添加实际的停止逻辑
        }
      }

      return (
        React.createElement('div', { className: 'max-w-screen-2xl mx-auto' },
          React.createElement(SearchCard, { 
            onQuery: setQuery, 
            onReset: () => setQuery({}) 
          }),
          React.createElement(TableCard, { 
            data: pageData, 
            onDetail: handleDetail,
            onStop: handleStop
          }),
          React.createElement(Pagination, { 
            total: filtered.length, 
            page, 
            pageSize, 
            onChange: setPage 
          })
        )
      )
    }

    ReactDOM.createRoot(document.getElementById('root')).render(React.createElement(App))
    
    // Header button events
    document.getElementById('langToggle').addEventListener('click', ()=>{
      const isEn = document.documentElement.getAttribute('lang') === 'en'
      document.documentElement.setAttribute('lang', isEn ? 'zh-CN' : 'en')
    });
    
    document.getElementById('themeToggle').addEventListener('click', ()=>{
      const isDark = document.documentElement.getAttribute('data-theme') === 'dark'
      document.documentElement.setAttribute('data-theme', isDark ? 'light' : 'dark')
    });
    
    document.getElementById('logoutBtn').addEventListener('click', ()=>{
      if(confirm('确定要退出登录吗？')) {
        alert('已退出登录')
      }
    });
  </script>
</body>
</html>
