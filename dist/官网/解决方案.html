<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è§£å†³æ–¹æ¡ˆ - ç®¡ç†ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="components/common.css">
    <style>
        /* è§£å†³æ–¹æ¡ˆç‰¹å®šæ ·å¼ */
        .solution-container {
            padding: 24px;
            background: #f5f5f5;
            min-height: calc(100vh - 56px);
        }

        .solution-header {
            background: white;
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 24px;
            text-align: center;
        }

        .solution-header h2 {
            font-size: 28px;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .solution-header p {
            color: #666;
            font-size: 16px;
            margin: 0;
        }

        /* Banneræ ·å¼ */
        .solution-banner {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 16px;
            padding: 40px;
            margin-bottom: 24px;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .solution-banner::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 200px;
            height: 200px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            transform: translate(50%, -50%);
        }

        .solution-banner::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 150px;
            height: 150px;
            background: rgba(255,255,255,0.05);
            border-radius: 50%;
            transform: translate(-30%, 30%);
        }

        .banner-content {
            position: relative;
            z-index: 1;
        }

        .banner-title {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 16px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .banner-subtitle {
            font-size: 18px;
            margin-bottom: 24px;
            opacity: 0.9;
        }

        .banner-features {
            display: flex;
            gap: 32px;
            margin-bottom: 32px;
            flex-wrap: wrap;
        }

        .banner-feature {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .banner-feature-icon {
            width: 24px;
            height: 24px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .banner-actions {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
        }

        .banner-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .banner-btn-primary {
            background: rgba(255,255,255,0.9);
            color: #333;
        }

        .banner-btn-primary:hover {
            background: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .banner-btn-secondary {
            background: rgba(255,255,255,0.1);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
        }

        .banner-btn-secondary:hover {
            background: rgba(255,255,255,0.2);
            border-color: rgba(255,255,255,0.5);
        }

        .solution-tabs {
            display: flex;
            gap: 4px;
            margin-bottom: 24px;
            background: #f8f9fa;
            padding: 4px;
            border-radius: 8px;
        }

        .solution-tab {
            flex: 1;
            padding: 12px 16px;
            border: none;
            background: transparent;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
        }

        .solution-tab.active {
            background: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            color: #1890ff;
        }

        .solution-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 24px;
        }

        .solution-grid.table-mode {
            display: block;
            grid-template-columns: none;
            gap: 0;
        }

        .solution-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .solution-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.12);
        }

        .solution-image {
            width: 100%;
            height: 200px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 48px;
            position: relative;
        }

        .solution-content {
            padding: 24px;
        }

        .solution-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 12px;
        }

        .solution-description {
            color: #666;
            line-height: 1.6;
            margin-bottom: 16px;
        }

        .solution-features {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 16px;
        }

        .feature-tag {
            padding: 4px 8px;
            background: #f0f2f5;
            border-radius: 4px;
            font-size: 12px;
            color: #666;
        }

        .solution-footer {
            display: flex;
            justify-content: between;
            align-items: center;
            padding-top: 16px;
            border-top: 1px solid #f0f0f0;
        }

        .solution-price {
            font-size: 18px;
            font-weight: 600;
            color: #1890ff;
        }

        .solution-actions {
            display: flex;
            gap: 8px;
        }

        .btn-detail, .btn-contact {
            padding: 8px 16px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }

        .btn-detail {
            background: #f0f2f5;
            color: #333;
        }

        .btn-detail:hover {
            background: #d9d9d9;
        }

        .btn-contact {
            background: #1890ff;
            color: white;
        }

        .btn-contact:hover {
            background: #40a9ff;
        }

        .stats-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .stat-item {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            text-align: center;
        }

        .stat-number {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .stat-label {
            font-size: 14px;
            color: #666;
        }

        .industry-solutions .stat-number { color: #52c41a; }
        .custom-solutions .stat-number { color: #1890ff; }
        .cloud-solutions .stat-number { color: #722ed1; }
        .mobile-solutions .stat-number { color: #fa8c16; }

        /* å›¾ç‰‡ç®¡ç†è¡¨æ ¼æ ·å¼ - ä¸æ–‡æ¡£èµ„æ–™é¡µé¢ä¸€è‡´ */
        .image-management-container {
            background: #fff;
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid rgba(0, 0, 0, 0.06);
        }

        .table-header {
            padding: 20px 24px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.06);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .table-title {
            font-size: 16px;
            font-weight: 500;
            color: #000;
            margin: 0;
        }


        .image-table {
            width: 100%;
        }

        .image-table th {
            text-align: left;
            padding: 16px 12px;
            font-size: 12px;
            font-weight: 500;
            color: rgba(0, 0, 0, 0.5);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            background: #fafafa;
            border-bottom: 1px solid rgba(0, 0, 0, 0.06);
        }

        .image-table td {
            padding: 16px 12px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.06);
            font-size: 14px;
            color: #000;
        }

        .image-table tbody tr:last-child td {
            border-bottom: none;
        }

        .image-table tbody tr {
            transition: background 0.15s;
        }

        .image-table tbody tr:hover {
            background: rgba(0, 0, 0, 0.02);
        }

        .image-preview {
            width: 80px;
            height: 60px;
            object-fit: cover;
            border-radius: 6px;
            border: 1px solid #e8e8e8;
        }

        .image-placeholder {
            width: 80px;
            height: 60px;
            background: #f5f5f5;
            border-radius: 6px;
            border: 2px dashed #d9d9d9;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
            font-size: 12px;
        }

        .action-buttons {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .btn-edit, .btn-delete, .btn-upload, .btn-preview {
            padding: 4px 8px;
            border: none;
            background: transparent;
            color: rgba(0, 0, 0, 0.6);
            font-size: 13px;
            cursor: pointer;
            transition: color 0.2s;
            text-decoration: none;
            text-align: left;
        }

        .btn-edit:hover, .btn-preview:hover {
            color: #000;
        }

        .btn-delete:hover {
            color: #000;
        }

        .btn-upload:hover {
            color: #000;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-active {
            background: #d1fae5;
            color: #065f46;
        }

        .status-inactive {
            background: #fed7aa;
            color: #92400e;
        }

        .empty-state {
            padding: 60px 20px;
            text-align: center;
            color: #999;
        }

        .empty-icon {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .empty-text {
            font-size: 16px;
            margin-bottom: 20px;
        }

        /* æ¨¡æ€æ¡†æ ·å¼ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            padding: 24px;
            width: 500px;
            max-width: 90vw;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin: 0;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: #999;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #333;
            font-size: 14px;
        }

        .form-input, .form-textarea, .form-select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #d9d9d9;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.2s;
        }

        .form-input:focus, .form-textarea:focus, .form-select:focus {
            outline: none;
            border-color: #1890ff;
            box-shadow: 0 0 0 2px rgba(24,144,255,0.1);
        }

        .form-textarea {
            min-height: 80px;
            resize: vertical;
        }

        .file-input-group {
            border: 2px dashed #d9d9d9;
            border-radius: 6px;
            padding: 20px;
            text-align: center;
            transition: border-color 0.2s;
            cursor: pointer;
        }

        .file-input-group:hover {
            border-color: #1890ff;
        }

        .file-input-group.dragover {
            border-color: #1890ff;
            background: rgba(24,144,255,0.05);
        }

        .file-input {
            display: none;
        }

        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            margin-top: 24px;
            padding-top: 20px;
            border-top: 1px solid #f0f0f0;
        }

        .btn-cancel, .btn-save {
            padding: 8px 16px;
            border: 1px solid rgba(0, 0, 0, 0.12);
            background: #fff;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .btn-cancel:hover {
            background: #000;
            color: #fff;
            border-color: #000;
        }

        .btn-save {
            background: #000;
            color: #fff;
            border-color: #000;
        }

        .btn-save:hover {
            background: #333;
            border-color: #333;
        }

        /* Navigation menu styles */
        .nav-group.expanded .nav-arrow {
            transform: rotate(90deg);
        }

        .nav-submenu {
            display: none;
            background: rgba(0, 0, 0, 0.02);
        }

        .nav-group.expanded .nav-submenu {
            display: block;
        }

        .nav-subitem {
            height: 40px;
            display: flex;
            align-items: center;
            padding: 0 20px 0 40px;
            color: rgba(0, 0, 0, 0.5);
            text-decoration: none;
            transition: all 0.2s;
            cursor: pointer;
            font-size: 14px;
            position: relative;
        }

        .nav-subitem:hover {
            color: #000;
            background: rgba(0, 0, 0, 0.03);
        }

        .nav-subitem.active {
            color: #000;
            background: rgba(0, 0, 0, 0.05);
        }

        .nav-subitem.active::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 3px;
            height: 100%;
            background: #000;
        }

        /* User Menu Styles */
        .user-menu {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: #000;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 500;
            font-size: 14px;
            cursor: pointer;
            margin-left: 8px;
            position: relative;
        }

        .user-dropdown {
            position: absolute;
            top: 45px;
            right: 0;
            background: #fff;
            border: 1px solid rgba(0, 0, 0, 0.08);
            border-radius: 8px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
            min-width: 160px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.2s ease;
            z-index: 1000;
        }

        .user-dropdown.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .dropdown-item {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            color: #374151;
            text-decoration: none;
            font-size: 14px;
            transition: background-color 0.15s ease;
            border: none;
            background: none;
            cursor: pointer;
            width: 100%;
            text-align: left;
        }

        .dropdown-item:hover {
            background: #f3f4f6;
        }

        /* Custom Modal Styles */
        .custom-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            opacity: 0;
            visibility: hidden;
            transition: all 0.2s ease;
        }

        .custom-modal.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            padding: 32px;
            max-width: 400px;
            width: 90%;
            text-align: center;
            transform: scale(0.9);
            transition: transform 0.2s ease;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

        .custom-modal.show .modal-content {
            transform: scale(1);
        }

        .modal-icon {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: #fef2f2;
            color: #dc2626;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 24px;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 600;
            color: #1f2937;
            margin: 0 0 12px 0;
        }

        .modal-message {
            color: #6b7280;
            line-height: 1.5;
            margin: 0 0 32px 0;
            font-size: 16px;
        }

        .modal-buttons {
            display: flex;
            gap: 12px;
            justify-content: center;
        }

        .modal-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.15s ease;
            min-width: 100px;
        }

        .modal-btn-cancel {
            background: #f3f4f6;
            color: #374151;
        }

        .modal-btn-cancel:hover {
            background: #e5e7eb;
        }

        .modal-btn-confirm {
            background: #dc2626;
            color: white;
        }

        .modal-btn-confirm:hover {
            background: #b91c1c;
        }

    </style>
</head>
<body>
    <div class="app">
        <!-- Universal Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="logo">
                <div class="logo-icon">
                    <img src="logo.png" alt="Logo">
                </div>
            </div>
            
            <nav class="nav">
                <!-- é¦–é¡µ -->
                <a href="é¦–é¡µ.html" class="nav-item" data-page="home">
                    <span class="nav-icon">
                        <svg viewBox="0 0 24 24">
                            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                            <polyline points="9,22 9,12 15,12 15,22"/>
                        </svg>
                    </span>
                    <span class="nav-text">é¦–é¡µ</span>
                </a>
                <!-- äº§å“ä¸­å¿ƒ -->
                <a href="äº§å“.html" class="nav-item" data-page="products">
                    <span class="nav-icon">
                        <svg viewBox="0 0 24 24">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                            <rect x="7" y="7" width="3" height="3"/>
                            <rect x="14" y="7" width="3" height="3"/>
                            <rect x="7" y="14" width="3" height="3"/>
                            <rect x="14" y="14" width="3" height="3"/>
                        </svg>
                    </span>
                    <span class="nav-text">äº§å“ä¸­å¿ƒ</span>
                </a>
                <!-- è§£å†³æ–¹æ¡ˆ -->
                <div class="nav-group" id="solutionsGroup">
                    <a href="#" class="nav-item" id="solutionsNav" data-page="solutions" onclick="toggleSubmenu('solutionsGroup', this)">
                        <span class="nav-icon">
                            <svg viewBox="0 0 24 24">
                                <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                            </svg>
                        </span>
                        <span class="nav-text">è§£å†³æ–¹æ¡ˆ</span>
                        <span class="nav-arrow">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                <path d="M6 4l4 4-4 4"/>
                            </svg>
                        </span>
                    </a>
                    <div class="nav-submenu" id="solutionsSubmenu">
                        <a href="è§£å†³æ–¹æ¡ˆ.html?type=banner" class="nav-subitem" data-section="banner">
                            <span class="nav-text">banner</span>
                        </a>
                        <a href="è§£å†³æ–¹æ¡ˆ.html?type=residential" class="nav-subitem" data-section="residential">
                            <span class="nav-text">æˆ·ç”¨</span>
                        </a>
                        <a href="è§£å†³æ–¹æ¡ˆ.html?type=commercial" class="nav-subitem" data-section="commercial">
                            <span class="nav-text">å·¥å•†å‚¨</span>
                        </a>
                        <a href="è§£å†³æ–¹æ¡ˆ.html?type=charging" class="nav-subitem" data-section="charging">
                            <span class="nav-text">å……ç”µç«™</span>
                        </a>
                    </div>
                </div>
                <!-- å¸®åŠ©ä¸­å¿ƒ -->
                <div class="nav-group" id="helpCenterGroup">
                    <a href="#" class="nav-item" id="helpCenterNav" data-page="help-center" onclick="toggleSubmenu('helpCenterGroup', this)">
                        <span class="nav-icon">
                            <svg viewBox="0 0 24 24">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
                                <circle cx="12" cy="17" r="0.5"/>
                            </svg>
                        </span>
                        <span class="nav-text">å¸®åŠ©ä¸­å¿ƒ</span>
                        <span class="nav-arrow">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                <path d="M6 4l4 4-4 4"/>
                            </svg>
                        </span>
                    </a>
                    <div class="nav-submenu" id="helpSubmenu">
                        <a href="æ–‡æ¡£èµ„æ–™.html" class="nav-subitem" data-section="documents">
                            <span class="nav-text">æ–‡æ¡£èµ„æ–™</span>
                        </a>
                        <a href="åœ¨çº¿å¸®åŠ©.html" class="nav-subitem" data-section="online-help">
                            <span class="nav-text">åœ¨çº¿å¸®åŠ©</span>
                        </a>
                    </div>
                </div>
                <!-- å…³äºæˆ‘ä»¬ -->
                <div class="nav-group" id="aboutUsGroup">
                    <a href="#" class="nav-item" id="aboutUsNav" data-page="about-us" onclick="toggleSubmenu('aboutUsGroup', this)">
                        <span class="nav-icon">
                            <svg viewBox="0 0 24 24">
                                <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                                <circle cx="8.5" cy="7" r="4"/>
                                <path d="M20 8v6M23 11h-6"/>
                            </svg>
                        </span>
                        <span class="nav-text">å…³äºæˆ‘ä»¬</span>
                        <span class="nav-arrow">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                <path d="M6 4l4 4-4 4"/>
                            </svg>
                        </span>
                    </a>
                    <div class="nav-submenu" id="aboutSubmenu">
                        <a href="å…³äºæˆ‘ä»¬.html" class="nav-subitem" data-section="about-xuhenew">
                            <span class="nav-text">å…³äºæ—­è¡¡</span>
                        </a>
                        <a href="è”ç³»æˆ‘ä»¬.html" class="nav-subitem" data-section="contact-us">
                            <span class="nav-text">è”ç³»æˆ‘ä»¬</span>
                        </a>
                    </div>
                </div>
            </nav>
        </aside>

        <!-- Main -->
        <main class="main">
            <!-- Header -->
            <header class="header">
                <h1 class="header-title">è§£å†³æ–¹æ¡ˆ</h1>
                <div class="header-actions">
                    <div class="user-menu" id="userAvatar">A
                        <div class="user-dropdown" id="userDropdown">
                            <button class="dropdown-item" id="logoutBtn">é€€å‡ºç™»å½•</button>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Content -->
            <div class="solution-container">
                <!-- ç»Ÿè®¡æ¦‚è§ˆ -->



                <!-- è§£å†³æ–¹æ¡ˆåˆ—è¡¨ -->
                <div class="solution-grid" id="solutionGrid">
                    <!-- è§£å†³æ–¹æ¡ˆå¡ç‰‡å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
        </main>
    </div>

    <script>
        // Toggle submenu function
        function toggleSubmenu(groupId, navItem) {
            console.log('Toggle submenu called:', groupId, navItem);
            const navGroup = document.getElementById(groupId);
            if (navGroup) {
                navGroup.classList.toggle('expanded');
                console.log('Group expanded:', navGroup.classList.contains('expanded'));
                
                // å¦‚æœå±•å¼€ï¼Œè®¾ç½®ä¸ºæ´»è·ƒçŠ¶æ€
                if (navGroup.classList.contains('expanded')) {
                    document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                    navItem.classList.add('active');
                }
            }
            return false;
        }

        // Universal Sidebar Functions
        function initUniversalSidebar() {
            // è·å–å½“å‰é¡µé¢è·¯å¾„
            const currentPath = window.location.pathname;
            const currentPage = currentPath.substring(currentPath.lastIndexOf('/') + 1);
            console.log('Full URL:', window.location.href);
            console.log('Current path:', currentPath);
            console.log('Current page:', currentPage);
            
            // è®¾ç½®å½“å‰é¡µé¢å¯¹åº”çš„å¯¼èˆªé¡¹ä¸ºæ´»è·ƒçŠ¶æ€
            setActiveNavigation(currentPage);
            
            // åˆå§‹åŒ–å¯¼èˆªé¡¹ç‚¹å‡»äº‹ä»¶ - å·²ä½¿ç”¨onclickå±æ€§ï¼Œæ— éœ€é¢å¤–ç»‘å®š
            // initNavigationEvents();
        }

        function setActiveNavigation(currentPage) {
            // æ¸…é™¤æ‰€æœ‰æ´»è·ƒçŠ¶æ€
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            document.querySelectorAll('.nav-subitem').forEach(item => item.classList.remove('active'));
            document.querySelectorAll('.nav-group').forEach(group => group.classList.remove('expanded'));
            
            // æ ¹æ®å½“å‰é¡µé¢è®¾ç½®æ´»è·ƒçŠ¶æ€
            switch(currentPage) {
                case 'é¦–é¡µ.html':
                case '':
                    document.querySelector('.nav-item[data-page="home"]')?.classList.add('active');
                    break;
                case 'äº§å“.html':
                    document.querySelector('.nav-item[data-page="products"]')?.classList.add('active');
                    break;
                case 'è§£å†³æ–¹æ¡ˆ.html':
                    console.log('Setting solutions menu as expanded');
                    document.getElementById('solutionsGroup').classList.add('expanded');
                    document.getElementById('solutionsNav').classList.add('active');
                    
                    // æ ¹æ®URLå‚æ•°å†³å®šæ¿€æ´»å“ªä¸ªå­èœå•é¡¹
                    const urlParams = new URLSearchParams(window.location.search);
                    const solutionType = urlParams.get('type');
                    if (solutionType) {
                        document.querySelector(`.nav-subitem[data-section="${solutionType}"]`)?.classList.add('active');
                    }
                    break;
                case 'æ–‡æ¡£èµ„æ–™.html':
                    document.getElementById('helpCenterGroup').classList.add('expanded');
                    document.getElementById('helpCenterNav').classList.add('active');
                    document.querySelector('.nav-subitem[data-section="documents"]')?.classList.add('active');
                    break;
                case 'åœ¨çº¿å¸®åŠ©.html':
                    document.getElementById('helpCenterGroup').classList.add('expanded');
                    document.getElementById('helpCenterNav').classList.add('active');
                    document.querySelector('.nav-subitem[data-section="online-help"]')?.classList.add('active');
                    break;
                case 'å…³äºæˆ‘ä»¬.html':
                    document.getElementById('aboutUsGroup').classList.add('expanded');
                    document.getElementById('aboutUsNav').classList.add('active');
                    document.querySelector('.nav-subitem[data-section="about-xuhenew"]')?.classList.add('active');
                    break;
                    document.getElementById('aboutUsGroup').classList.add('expanded');
                    document.getElementById('aboutUsNav').classList.add('active');
                    document.querySelector('.nav-subitem[data-section="join-us"]')?.classList.add('active');
                    break;
                case 'è”ç³»æˆ‘ä»¬.html':
                    document.getElementById('aboutUsGroup').classList.add('expanded');
                    document.getElementById('aboutUsNav').classList.add('active');
                    document.querySelector('.nav-subitem[data-section="contact-us"]')?.classList.add('active');
                    break;
                    document.getElementById('aboutUsGroup').classList.add('expanded');
                    document.getElementById('aboutUsNav').classList.add('active');
                    document.querySelector('.nav-subitem[data-section="latest-news"]')?.classList.add('active');
                    break;
                    document.querySelector('.nav-item[data-page="cloud-demo"]')?.classList.add('active');
                    break;
            }
        }

        function initNavigationEvents() {
            // ä¸€çº§èœå•ç‚¹å‡»äº‹ä»¶
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function(e) {
                    const textElement = this.querySelector('.nav-text');
                    if (!textElement) return;
                    
                    const title = textElement.textContent.trim();
                    
                    if (title === 'å¸®åŠ©ä¸­å¿ƒ') {
                        const href = this.getAttribute('href');
                        
                        // å¦‚æœæ˜¯è·³è½¬åˆ°å…¶ä»–é¡µé¢çš„é“¾æ¥ï¼Œå…è®¸é»˜è®¤è¡Œä¸º
                        if (href && (href.endsWith('.html') && href !== window.location.pathname.split('/').pop())) {
                            // ä¸é˜»æ­¢é»˜è®¤è¡Œä¸ºï¼Œè®©æµè§ˆå™¨æ­£å¸¸è·³è½¬
                            return;
                        }
                        
                        e.preventDefault();
                        // åˆ‡æ¢å¸®åŠ©ä¸­å¿ƒå­èœå•å±•å¼€çŠ¶æ€
                        const navGroup = this.closest('.nav-group');
                        navGroup.classList.toggle('expanded');
                        
                        // å¦‚æœå±•å¼€ï¼Œè®¾ç½®ä¸ºæ´»è·ƒçŠ¶æ€
                        if (navGroup.classList.contains('expanded')) {
                            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                            this.classList.add('active');
                        }
                    } else if (title === 'è§£å†³æ–¹æ¡ˆ') {
                        e.preventDefault();
                        // åˆ‡æ¢è§£å†³æ–¹æ¡ˆå­èœå•å±•å¼€çŠ¶æ€
                        const navGroup = this.closest('.nav-group');
                        navGroup.classList.toggle('expanded');
                        
                        // å¦‚æœå±•å¼€ï¼Œè®¾ç½®ä¸ºæ´»è·ƒçŠ¶æ€
                        if (navGroup.classList.contains('expanded')) {
                            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                            this.classList.add('active');
                        }
                    } else if (title === 'å…³äºæˆ‘ä»¬') {
                        const href = this.getAttribute('href');
                        
                        // å¦‚æœæ˜¯è·³è½¬åˆ°å…¶ä»–é¡µé¢çš„é“¾æ¥ï¼Œå…è®¸é»˜è®¤è¡Œä¸º
                        if (href && (href.endsWith('.html') && href !== window.location.pathname.split('/').pop())) {
                            // ä¸é˜»æ­¢é»˜è®¤è¡Œä¸ºï¼Œè®©æµè§ˆå™¨æ­£å¸¸è·³è½¬
                            return;
                        }
                        
                        e.preventDefault();
                        // åˆ‡æ¢å…³äºæˆ‘ä»¬å­èœå•å±•å¼€çŠ¶æ€
                        const navGroup = this.closest('.nav-group');
                        navGroup.classList.toggle('expanded');
                        
                        // å¦‚æœå±•å¼€ï¼Œè®¾ç½®ä¸ºæ´»è·ƒçŠ¶æ€
                        if (navGroup.classList.contains('expanded')) {
                            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                            this.classList.add('active');
                        }
                    }
                });
            });
        }

        // ä»localStorageåŠ è½½Banneré…ç½®æ•°æ®ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä½¿ç”¨é»˜è®¤é…ç½®
        let bannerConfig = {
            banner: {
                title: "Bannerç®¡ç†ç³»ç»Ÿ",
                subtitle: "ç®¡ç†å’Œé…ç½®å„ç±»æ¨ªå¹…å±•ç¤ºå†…å®¹ï¼Œæä¾›çµæ´»çš„å±•ç¤ºæ–¹æ¡ˆ",
                features: [
                    { icon: "ğŸ¨", text: "è‡ªå®šä¹‰è®¾è®¡" },
                    { icon: "ğŸ“±", text: "å“åº”å¼å¸ƒå±€" },
                    { icon: "âš¡", text: "å¿«é€Ÿéƒ¨ç½²" },
                    { icon: "ğŸ“Š", text: "æ•°æ®ç»Ÿè®¡" }
                ],
                primaryAction: { text: "åˆ›å»ºBanner", action: "create" },
                secondaryAction: { text: "æ¨¡æ¿åº“", action: "templates" }
            },
            residential: {
                title: "",
                subtitle: "",
                features: [],
                primaryAction: { text: "", action: "" },
                secondaryAction: { text: "", action: "" }
            },
            commercial: {
                title: "å·¥å•†å‚¨èƒ½ é™æœ¬å¢æ•ˆ",
                subtitle: "ä¸ºå·¥å•†ä¸šç”¨æˆ·æä¾›ä¸“ä¸šçš„å‚¨èƒ½è§£å†³æ–¹æ¡ˆï¼Œæœ‰æ•ˆé™ä½ç”¨ç”µæˆæœ¬",
                features: [
                    { icon: "ğŸ“Š", text: "å‰Šå³°å¡«è°·" },
                    { icon: "ğŸ’¼", text: "éœ€é‡ç®¡ç†" },
                    { icon: "ğŸ”‹", text: "å¤§å®¹é‡å‚¨èƒ½" },
                    { icon: "ğŸ“ˆ", text: "æ”¶ç›Šåˆ†æ" }
                ],
                primaryAction: { text: "æ–¹æ¡ˆå®šåˆ¶", action: "customize" },
                secondaryAction: { text: "æ¡ˆä¾‹åˆ†äº«", action: "cases" }
            },
            charging: {
                title: "å……ç”µç«™å»ºè®¾ ç»¿è‰²å‡ºè¡Œ",
                subtitle: "æ„å»ºæ™ºèƒ½åŒ–å……ç”µåŸºç¡€è®¾æ–½ï¼ŒåŠ©åŠ›ç”µåŠ¨æ±½è½¦äº§ä¸šå‘å±•",
                features: [
                    { icon: "ğŸš—", text: "å¿«é€Ÿå……ç”µ" },
                    { icon: "ğŸŒ±", text: "ç»¿è‰²èƒ½æº" },
                    { icon: "ğŸ’³", text: "ä¾¿æ·æ”¯ä»˜" },
                    { icon: "ğŸ”§", text: "æ™ºèƒ½è¿ç»´" }
                ],
                primaryAction: { text: "å»ºç«™å’¨è¯¢", action: "build" },
                secondaryAction: { text: "è¿è¥æ”¯æŒ", action: "support" }
            }
        };

        // è§£å†³æ–¹æ¡ˆæ•°æ®
        const solutions = {
            // æˆ·ç”¨è§£å†³æ–¹æ¡ˆ
            residential: [
                // æˆ·ç”¨è§£å†³æ–¹æ¡ˆå†…å®¹å·²æ¸…ç©º
            ],
            // å·¥å•†å‚¨è§£å†³æ–¹æ¡ˆ
            commercial: [
                // å·¥å•†å‚¨è§£å†³æ–¹æ¡ˆå†…å®¹å·²æ¸…ç©º
            ],
            // å……ç”µç«™è§£å†³æ–¹æ¡ˆ
            charging: [
                // å……ç”µç«™è§£å†³æ–¹æ¡ˆå†…å®¹å·²æ¸…ç©º
            ]
        };

        // è·å–å½“å‰è§£å†³æ–¹æ¡ˆç±»å‹
        function getCurrentSolutionType() {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('type') || 'residential'; // é»˜è®¤æ˜¾ç¤ºæˆ·ç”¨è§£å†³æ–¹æ¡ˆ
        }

        // æ¸²æŸ“Banner
        function renderBanner() {
            const bannerElement = document.getElementById('solutionBanner');
            const solutionType = getCurrentSolutionType();
            const bannerData = bannerConfig[solutionType];
            
            if (!bannerData) {
                bannerElement.style.display = 'none';
                return;
            }
            
            bannerElement.style.display = 'block';
            bannerElement.innerHTML = `
                <div class="banner-content">
                    <div class="banner-title">${bannerData.title}</div>
                    <div class="banner-subtitle">${bannerData.subtitle}</div>
                    <div class="banner-features">
                        ${bannerData.features.map(feature => `
                            <div class="banner-feature">
                                <div class="banner-feature-icon">${feature.icon}</div>
                                <span>${feature.text}</span>
                            </div>
                        `).join('')}
                    </div>
                    <div class="banner-actions">
                        <button class="banner-btn banner-btn-primary" onclick="handleBannerAction('${bannerData.primaryAction.action}')">
                            ${bannerData.primaryAction.text}
                        </button>
                        <button class="banner-btn banner-btn-secondary" onclick="handleBannerAction('${bannerData.secondaryAction.action}')">
                            ${bannerData.secondaryAction.text}
                        </button>
                    </div>
                </div>
            `;
        }

        // æ¸²æŸ“è§£å†³æ–¹æ¡ˆåˆ—è¡¨æˆ–å›¾ç‰‡ç®¡ç†è¡¨æ ¼
        function renderSolutions() {
            const solutionGrid = document.getElementById('solutionGrid');
            const solutionType = getCurrentSolutionType();
            
            // æ›´æ–°é¡µé¢æ ‡é¢˜
            updatePageTitle(solutionType);
            
            if (solutionType === 'banner') {
                // banneré¡µé¢æ˜¾ç¤ºå›¾ç‰‡ç®¡ç†è¡¨æ ¼
                renderImageManagementTable();
            } else {
                // å…¶ä»–è§£å†³æ–¹æ¡ˆæ˜¾ç¤ºå¾…å¼€å‘ä¸­çŠ¶æ€ï¼Œç§»é™¤table-modeç±»
                solutionGrid.classList.remove('table-mode');
                const currentSolutions = solutions[solutionType] || [];
                
                if (currentSolutions.length === 0) {
                    // æ˜¾ç¤ºå¾…å¼€å‘ä¸­çŠ¶æ€
                    const titleMap = {
                        'residential': 'æˆ·ç”¨å¾…å¼€å‘ä¸­',
                        'commercial': 'å·¥å•†å‚¨å¾…å¼€å‘ä¸­', 
                        'charging': 'å……ç”µç«™å¾…å¼€å‘ä¸­'
                    };
                    const pageTitle = titleMap[solutionType] || 'å†…å®¹å¾…å¼€å‘ä¸­';
                    
                    solutionGrid.innerHTML = `
                        <div style="display: flex; align-items: center; justify-content: center; min-height: 70vh; grid-column: 1/-1;">
                            <div style="text-align: center; color: rgba(0, 0, 0, 0.6);">
                                <div style="font-size: 48px; margin-bottom: 20px;">ğŸš§</div>
                                <h2 style="font-size: 24px; margin-bottom: 10px; color: #000;">${pageTitle}</h2>
                                <p style="font-size: 16px;">é¡µé¢æ­£åœ¨å¼€å‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…</p>
                            </div>
                        </div>
                    `;
                } else {
                    solutionGrid.innerHTML = currentSolutions.map(solution => `
                        <div class="solution-card">
                            <div class="solution-image">
                                ${solution.icon}
                            </div>
                            <div class="solution-content">
                                <h3 class="solution-title">${solution.title}</h3>
                                <p class="solution-description">${solution.description}</p>
                                <div class="solution-features">
                                    ${solution.features.map(feature => `<span class="feature-tag">${feature}</span>`).join('')}
                                </div>
                                <div class="solution-footer">
                                    <div class="solution-price">${solution.price}</div>
                                    <div class="solution-actions">
                                        <button class="btn-detail" onclick="viewDetail(${solution.id})">è¯¦æƒ…</button>
                                        <button class="btn-contact" onclick="contactUs(${solution.id})">å’¨è¯¢</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `).join('');
                }
            }
        }

        // æ›´æ–°é¡µé¢æ ‡é¢˜
        function updatePageTitle(solutionType) {
            const titleElement = document.getElementById('solutionTitle');
            const subtitleElement = document.getElementById('solutionSubtitle');
            const headerTitle = document.querySelector('.header-title');
            
            const titleMap = {
                'residential': {
                    title: 'æˆ·ç”¨è§£å†³æ–¹æ¡ˆ',
                    subtitle: ''
                },
                'commercial': {
                    title: 'å·¥å•†å‚¨è§£å†³æ–¹æ¡ˆ',
                    subtitle: 'ä¸ºå·¥å•†ä¸šç”¨æˆ·æä¾›çš„å¤§å®¹é‡å‚¨èƒ½ä¸èƒ½æºç®¡ç†ç³»ç»Ÿ'
                },
                'charging': {
                    title: 'å……ç”µç«™è§£å†³æ–¹æ¡ˆ',
                    subtitle: 'ç”µåŠ¨æ±½è½¦å……ç”µåŸºç¡€è®¾æ–½åŠå‚¨èƒ½ä¸€ä½“åŒ–è§£å†³æ–¹æ¡ˆ'
                }
            };
            
            const config = titleMap[solutionType] || titleMap['residential'];
            if (titleElement) titleElement.textContent = config.title;
            if (subtitleElement) subtitleElement.textContent = config.subtitle;
            if (headerTitle) headerTitle.textContent = config.title;
        }

        // æŸ¥çœ‹è¯¦æƒ…
        function viewDetail(id) {
            alert(`æŸ¥çœ‹è§£å†³æ–¹æ¡ˆè¯¦æƒ… ID: ${id}`);
        }

        // è”ç³»å’¨è¯¢
        function contactUs(id) {
            alert(`å’¨è¯¢è§£å†³æ–¹æ¡ˆ ID: ${id}`);
        }

        // å¤„ç†BanneræŒ‰é’®ç‚¹å‡»
        function handleBannerAction(action) {
            switch(action) {
                case 'contact':
                    alert('ç«‹å³å’¨è¯¢ - ä¸“ä¸šå®¢æœå°†ä¸ºæ‚¨æä¾›ä¸€å¯¹ä¸€æœåŠ¡');
                    break;
                case 'download':
                    alert('äº§å“æ‰‹å†Œä¸‹è½½ - è¯¦ç»†äº†è§£äº§å“è§„æ ¼å’ŒæŠ€æœ¯å‚æ•°');
                    break;
                case 'customize':
                    alert('æ–¹æ¡ˆå®šåˆ¶ - æ ¹æ®æ‚¨çš„éœ€æ±‚å®šåˆ¶ä¸“å±è§£å†³æ–¹æ¡ˆ');
                    break;
                case 'cases':
                    alert('æ¡ˆä¾‹åˆ†äº« - æŸ¥çœ‹æˆåŠŸæ¡ˆä¾‹å’Œå®¢æˆ·åé¦ˆ');
                    break;
                case 'build':
                    alert('å»ºç«™å’¨è¯¢ - ä¸“ä¸šå›¢é˜Ÿä¸ºæ‚¨è§„åˆ’å……ç”µç«™å»ºè®¾æ–¹æ¡ˆ');
                    break;
                case 'support':
                    alert('è¿è¥æ”¯æŒ - æä¾›å…¨æ–¹ä½çš„å……ç”µç«™è¿è¥ç®¡ç†æœåŠ¡');
                    break;
                default:
                    alert('åŠŸèƒ½å¼€å‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…');
            }
        }



        // å›¾ç‰‡ç®¡ç†æ•°æ®
        let imageData = JSON.parse(localStorage.getItem('residentialImages')) || [
            {
                id: 1,
                name: "é¦–é¡µè½®æ’­å›¾1",
                description: "æˆ·ç”¨å‚¨èƒ½ç³»ç»Ÿä¸»è¦å±•ç¤ºå›¾ç‰‡",
                url: "https://picsum.photos/800/600?random=1",
                page: "æˆ·ç”¨",
                status: "active",
                uploadDate: "2024-01-15 09:30:00"
            },
            {
                id: 2,
                name: "äº§å“è¯¦æƒ…å›¾",
                description: "æˆ·ç”¨å…‰å‚¨ä¸€ä½“æœºäº§å“å±•ç¤º",
                url: "https://picsum.photos/800/600?random=2",
                page: "å·¥å•†å‚¨",
                status: "active",
                uploadDate: "2024-01-20 14:15:30"
            },
            {
                id: 3,
                name: "åº”ç”¨åœºæ™¯å›¾",
                description: "å®¶åº­åº”ç”¨åœºæ™¯ç¤ºæ„å›¾",
                url: "https://picsum.photos/800/600?random=3",
                page: "å……ç”µç«™",
                status: "inactive",
                uploadDate: "2024-01-25 16:45:12"
            }
        ];

        // æ¸²æŸ“å›¾ç‰‡ç®¡ç†è¡¨æ ¼
        function renderImageManagementTable() {
            const solutionGrid = document.getElementById('solutionGrid');
            // æ·»åŠ table-modeç±»ï¼Œè®©è¡¨æ ¼é“ºæ»¡æ•´ä¸ªåŒºåŸŸ
            solutionGrid.classList.add('table-mode');
            solutionGrid.innerHTML = `
                <div class="image-management-container">
                    <div class="table-header">
                        <h3 class="table-title">bannerç®¡ç†</h3>
                    </div>
                    <div class="table-container">
                        ${imageData.length > 0 ? renderImageTable() : renderEmptyState()}
                    </div>
                </div>
            `;
        }

        // æ¸²æŸ“å›¾ç‰‡è¡¨æ ¼
        function renderImageTable() {
            return `
                <table class="image-table">
                    <thead>
                        <tr>
                            <th style="width: 200px;">æ‰€å±é¡µé¢</th>
                            <th style="width: 150px; text-align: left; white-space: nowrap; margin-left: -500px;">ä¸Šä¼ æ—¶é—´</th>
                            <th style="width: 150px;">æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${imageData.map(image => `
                            <tr>
                                <td style="font-weight: 500; color: #000;">${image.page}</td>
                                <td style="color: rgba(0, 0, 0, 0.6); white-space: nowrap; margin-left: -500px;">${image.uploadDate}</td>
                                <td>
                                    <div class="action-buttons">
                                        ${image.url ? `<button class="btn-preview" onclick="previewImage(${image.id})">é¢„è§ˆ</button>` : ''}
                                        <button class="btn-edit" onclick="editImage(${image.id})">ç¼–è¾‘</button>
                                    </div>
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        // æ¸²æŸ“ç©ºçŠ¶æ€
        function renderEmptyState() {
            return `
                <div class="empty-state">
                    <div class="empty-icon">ğŸ–¼ï¸</div>
                    <div class="empty-text">æš‚æ— banneræ•°æ®</div>
                </div>
            `;
        }

        // æ‰“å¼€å›¾ç‰‡ç¼–è¾‘æ¨¡æ€æ¡†
        function openImageModal(imageId = null) {
            const isEdit = imageId !== null;
            const image = isEdit ? imageData.find(img => img.id === imageId) : null;
            
            const modalHtml = `
                <div class="modal-overlay" id="imageModal" onclick="closeModal(event)">
                    <div class="modal-content" onclick="event.stopPropagation()">
                        <div class="modal-header">
                            <h3 class="modal-title">${isEdit ? 'ç¼–è¾‘å›¾ç‰‡' : 'æ·»åŠ å›¾ç‰‡'}</h3>
                            <button class="modal-close" onclick="closeModal()">&times;</button>
                        </div>
                        <form id="imageForm">
                            <div class="form-group">
                                <label class="form-label">æ‰€å±é¡µé¢</label>
                                <input type="text" class="form-input" id="imagePage" value="${image?.page || ''}" readonly style="background-color: #f5f5f5; cursor: not-allowed;">
                            </div>
                            <div class="form-group">
                                <label class="form-label">å›¾ç‰‡æ–‡ä»¶</label>
                                <div class="file-input-group" onclick="document.getElementById('imageFile').click()">
                                    <input type="file" class="file-input" id="imageFile" accept="image/*" onchange="handleFileSelect(this)">
                                    <div id="fileDropZone">
                                        ${image?.url ? 
                                            `<img src="${image.url}" style="max-width: 200px; max-height: 150px; border-radius: 6px; margin-bottom: 10px;"><br>` :
                                            ''
                                        }
                                        <div style="color: #000; font-weight: 500;">ç‚¹å‡»é€‰æ‹©æ–‡ä»¶æˆ–æ‹–æ‹½åˆ°è¿™é‡Œ</div>
                                        <div style="color: #999; font-size: 12px; margin-top: 4px;">æ”¯æŒ JPG, PNG, GIF æ ¼å¼ï¼Œæœ€å¤§ 5MB</div>
                                    </div>
                                </div>
                            </div>
                        </form>
                        <div class="modal-actions">
                            <button class="btn-cancel" onclick="closeModal()">å–æ¶ˆ</button>
                            <button class="btn-save" onclick="saveImage(${imageId})">${isEdit ? 'ä¿å­˜' : 'æ·»åŠ '}</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHtml);
            setupFileDropZone();
        }

        // è®¾ç½®æ–‡ä»¶æ‹–æ‹½åŠŸèƒ½
        function setupFileDropZone() {
            const dropZone = document.getElementById('fileDropZone');
            const fileInput = document.getElementById('imageFile');
            
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, preventDefaults, false);
            });
            
            ['dragenter', 'dragover'].forEach(eventName => {
                dropZone.addEventListener(eventName, () => dropZone.parentElement.classList.add('dragover'), false);
            });
            
            ['dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, () => dropZone.parentElement.classList.remove('dragover'), false);
            });
            
            dropZone.addEventListener('drop', handleDrop, false);
            
            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }
            
            function handleDrop(e) {
                const dt = e.dataTransfer;
                const files = dt.files;
                if (files.length > 0) {
                    fileInput.files = files;
                    handleFileSelect(fileInput);
                }
            }
        }

        // å¤„ç†æ–‡ä»¶é€‰æ‹©
        function handleFileSelect(input) {
            const file = input.files[0];
            if (file) {
                if (file.size > 5 * 1024 * 1024) {
                    alert('æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡5MB');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    const dropZone = document.getElementById('fileDropZone');
                    dropZone.innerHTML = `
                        <img src="${e.target.result}" style="max-width: 200px; max-height: 150px; border-radius: 6px; margin-bottom: 10px;"><br>
                        <div style="color: #52c41a; font-weight: 500;">âœ“ ${file.name}</div>
                        <div style="color: #999; font-size: 12px; margin-top: 4px;">ç‚¹å‡»å¯é‡æ–°é€‰æ‹©æ–‡ä»¶</div>
                    `;
                };
                reader.readAsDataURL(file);
            }
        }

        // ä¿å­˜å›¾ç‰‡
        function saveImage(imageId) {
            const form = document.getElementById('imageForm');
            const formData = new FormData(form);
            const fileInput = document.getElementById('imageFile');
            
            const imageInfo = {
                id: imageId || Date.now(),
                name: `${document.getElementById('imagePage').value}banner`,
                description: `${document.getElementById('imagePage').value}é¡µé¢bannerå›¾ç‰‡`,
                page: document.getElementById('imagePage').value,
                status: 'active',
                uploadDate: imageId ? imageData.find(img => img.id === imageId)?.uploadDate : new Date().toLocaleString('zh-CN', {year: 'numeric', month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit', second: '2-digit'}).replace(/\//g, '-'),
                url: ''
            };
            
            // å¤„ç†å›¾ç‰‡æ–‡ä»¶
            if (fileInput.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    imageInfo.url = e.target.result;
                    updateImageData(imageInfo, imageId);
                };
                reader.readAsDataURL(fileInput.files[0]);
            } else {
                // å¦‚æœæ²¡æœ‰é€‰æ‹©æ–°æ–‡ä»¶ï¼Œä¿æŒåŸæ¥çš„URL
                if (imageId) {
                    const existingImage = imageData.find(img => img.id === imageId);
                    imageInfo.url = existingImage?.url || '';
                }
                updateImageData(imageInfo, imageId);
            }
        }

        // æ›´æ–°å›¾ç‰‡æ•°æ®
        function updateImageData(imageInfo, imageId) {
            if (imageId) {
                const index = imageData.findIndex(img => img.id === imageId);
                if (index !== -1) {
                    imageData[index] = imageInfo;
                }
            } else {
                imageData.push(imageInfo);
            }
            
            localStorage.setItem('residentialImages', JSON.stringify(imageData));
            closeModal();
            renderImageManagementTable();
            alert('ä¿å­˜æˆåŠŸï¼');
        }

        // é¢„è§ˆå›¾ç‰‡
        function previewImage(imageId) {
            const image = imageData.find(img => img.id === imageId);
            if (image && image.url) {
                const previewModal = document.createElement('div');
                previewModal.className = 'modal-overlay';
                previewModal.innerHTML = `
                    <div style="text-align: center; color: white; font-size: 16px;">
                        åŠ è½½ä¸­...
                    </div>
                `;
                document.body.appendChild(previewModal);
                
                // é¢„åŠ è½½å›¾ç‰‡
                const img = new Image();
                img.onload = function() {
                    previewModal.innerHTML = `
                        <div style="position: relative; display: inline-block;">
                            <button class="modal-close" onclick="this.closest('.modal-overlay').remove()" style="position: absolute; top: -50px; right: 0px; background: rgba(255,255,255,0.9); color: #000; border: 2px solid #000; width: 40px; height: 40px; border-radius: 50%; font-size: 20px; cursor: pointer; font-weight: bold;">&times;</button>
                            <img src="${image.url}" alt="é¢„è§ˆå›¾ç‰‡" style="max-width: 90vw; max-height: 90vh; object-fit: contain; display: block; border-radius: 12px;">
                        </div>
                    `;
                };
                img.onerror = function() {
                    previewModal.innerHTML = `
                        <div style="text-align: center; color: white; font-size: 16px;">
                            å›¾ç‰‡åŠ è½½å¤±è´¥
                            <br><br>
                            <button onclick="this.closest('.modal-overlay').remove()" style="padding: 10px 20px; background: white; border: none; border-radius: 5px; cursor: pointer;">å…³é—­</button>
                        </div>
                    `;
                };
                img.src = image.url;
                
                // ç‚¹å‡»é®ç½©å…³é—­
                previewModal.onclick = (e) => {
                    if (e.target === previewModal) {
                        previewModal.remove();
                    }
                };
            }
        }

        // ç¼–è¾‘å›¾ç‰‡
        function editImage(imageId) {
            openImageModal(imageId);
        }

        // ä¸Šä¼ å›¾ç‰‡ï¼ˆé’ˆå¯¹æ²¡æœ‰å›¾ç‰‡çš„æ¡ç›®ï¼‰
        function uploadImage(imageId) {
            openImageModal(imageId);
        }

        // åˆ é™¤å›¾ç‰‡
        function deleteImage(imageId) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™å¼ å›¾ç‰‡å—ï¼Ÿ')) {
                imageData = imageData.filter(img => img.id !== imageId);
                localStorage.setItem('residentialImages', JSON.stringify(imageData));
                renderImageManagementTable();
                alert('åˆ é™¤æˆåŠŸï¼');
            }
        }

        // å…³é—­æ¨¡æ€æ¡†
        function closeModal(event) {
            if (event && event.target.classList.contains('modal-content')) return;
            const modal = document.getElementById('imageModal');
            if (modal) {
                modal.remove();
            }
        }

        // åˆå§‹åŒ–é¡µé¢
        document.addEventListener('DOMContentLoaded', async function() {
            
            // åˆå§‹åŒ–é€šç”¨ä¾§è¾¹æ 
            initUniversalSidebar();
            
            
            // æ¸²æŸ“è§£å†³æ–¹æ¡ˆåˆ—è¡¨
            renderSolutions();
            
            // å¼ºåˆ¶ç¡®ä¿è§£å†³æ–¹æ¡ˆèœå•å±•å¼€
            setTimeout(() => {
                const solutionsGroup = document.getElementById('solutionsGroup');
                const solutionsNav = document.getElementById('solutionsNav');
                if (solutionsGroup && solutionsNav) {
                    solutionsGroup.classList.add('expanded');
                    solutionsNav.classList.add('active');
                    console.log('Force expanded solutions menu');
                }
            }, 100);
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', (e) => {
            const userAvatar = document.getElementById('userAvatar');
            const userDropdown = document.getElementById('userDropdown');
            if (userDropdown && !userAvatar.contains(e.target)) {
                userDropdown.classList.remove('show');
            }
        });

        // User Authentication and Logout
        // No authentication required - direct access
        const userName = 'Admin'; // é»˜è®¤ç”¨æˆ·å

        // Set avatar
        const userAvatar = document.getElementById('userAvatar');
        userAvatar.childNodes[0].textContent = userName.charAt(0).toUpperCase();
        
        // User menu functionality
        const userDropdown = document.getElementById('userDropdown');
        const logoutBtn = document.getElementById('logoutBtn');
        
        // Toggle dropdown on avatar click
        userAvatar.addEventListener('click', (e) => {
            e.stopPropagation();
            userDropdown.classList.toggle('show');
        });
        
        // Logout button click
        logoutBtn.addEventListener('click', () => {
            // Close dropdown first
            userDropdown.classList.remove('show');
            
            // Show custom modal
            const logoutModal = document.getElementById('logoutModal');
            logoutModal.classList.add('show');
        });
        
        // Modal event listeners
        const logoutModal = document.getElementById('logoutModal');
        const cancelLogout = document.getElementById('cancelLogout');
        const confirmLogout = document.getElementById('confirmLogout');
        
        // Cancel logout function
        function hideLogoutModal() {
            const logoutModal = document.getElementById('logoutModal');
            logoutModal.classList.remove('show');
        }
        
        // Cancel logout event listener (backup)
        cancelLogout.addEventListener('click', () => {
            logoutModal.classList.remove('show');
        });
        
        // Logout function
        function performLogout() {
            console.log('performLogout called!');
            // Clear all login tokens
            localStorage.removeItem('adminToken');
            localStorage.removeItem('adminUser');
            sessionStorage.removeItem('adminToken');
            sessionStorage.removeItem('adminUser');
            
            console.log('Tokens cleared, redirecting...');
            // Redirect to login page
            window.location.href = 'ç™»å½•é¡µé¢.html';
        }

        // Confirm logout
        if (confirmLogout) {
            confirmLogout.addEventListener('click', performLogout);
        } else {
            console.error('confirmLogout element not found!');
        }
        
        // Close modal when clicking backdrop
        logoutModal.addEventListener('click', (e) => {
            if (e.target === logoutModal) {
                logoutModal.classList.remove('show');
            }
        });
        
    </script>
    
    <!-- Custom Logout Confirmation Modal -->
    <div class="custom-modal" id="logoutModal">
        <div class="modal-content">
            <div class="modal-icon">âš ï¸</div>
            <h3 class="modal-title">ç¡®è®¤é€€å‡º</h3>
            <p class="modal-message">ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿé€€å‡ºåéœ€è¦é‡æ–°ç™»å½•æ‰èƒ½ä½¿ç”¨ç³»ç»Ÿã€‚</p>
            <div class="modal-buttons">
                <button class="modal-btn modal-btn-cancel" id="cancelLogout" onclick="hideLogoutModal()">å–æ¶ˆ</button>
                <button class="modal-btn modal-btn-confirm" id="confirmLogout" onclick="performLogout()">ç¡®è®¤é€€å‡º</button>
            </div>
        </div>
    </div>

</body>
</html>